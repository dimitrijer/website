%!TEX TS-program = xelatex
%!TEX encoding = UTF-8 Unicode

\documentclass[11pt, a4paper]{article}
\usepackage{fontspec} 

% DOCUMENT LAYOUT
\usepackage[margin=1.2in]{geometry} 
\setlength\parindent{0cm}
\setlength\parskip{0.3cm}

% fix for pandoc 1.14
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}

% Taken from pandoc default template.
$if(csl-refs)$
\newlength{\cslhangindent}
\setlength{\cslhangindent}{1.5em}
\newlength{\csllabelwidth}
\setlength{\csllabelwidth}{3em}
\newlength{\cslentryspacingunit} % times entry-spacing
\setlength{\cslentryspacingunit}{\parskip}
\newenvironment{CSLReferences}[2] % #1 hanging-ident, #2 entry spacing
 {% don't indent paragraphs
  \setlength{\parindent}{0pt}
  % turn on hanging indent if param 1 is 1
  \ifodd #1
  \let\oldpar\par
  \def\par{\hangindent=\cslhangindent\oldpar}
  \fi
  % set entry spacing
  \setlength{\parskip}{#2\cslentryspacingunit}
 }%
 {}
\usepackage{calc}
\newcommand{\CSLBlock}[1]{#1\hfill\break}
\newcommand{\CSLLeftMargin}[1]{\parbox[t]{\csllabelwidth}{#1}}
\newcommand{\CSLRightInline}[1]{\parbox[t]{\linewidth - \csllabelwidth}{#1}\break}
\newcommand{\CSLIndent}[1]{\hspace{\cslhangindent}#1}
$endif$

% Reduce spacing in itemize, enumerate and titles
\usepackage{multicol}

% LINKS
\usepackage[colorlinks,allcolors=blue]{hyperref}

% FONTS
\defaultfontfeatures{Path=TEXLIVE_PATH/share/texmf/fonts/opentype/public/fontawesome/}
\usepackage{fontawesome}
\usepackage{xunicode}
\usepackage{xltxtra}
\defaultfontfeatures{Mapping=tex-text} % converts LaTeX specials (quotes'' --- dashes etc.) to unicode

% HEADINGS and TITLES
\usepackage{sectsty}
\usepackage[normalem]{ulem}
\sectionfont{\sffamily\mdseries\large\underline} % Underlines headings
\setcounter{secnumdepth}{-1} % Removes the numbers before sections
\subsectionfont{\rmfamily\mdseries\scshape\normalsize}
\subsubsectionfont{\rmfamily\bfseries\upshape\normalsize}

% Math symbols
\usepackage{amssymb}
\usepackage{enumitem}
\setenumerate{nolistsep}
\setitemize{nolistsep}
% Nested itemize symbols
\setlist[itemize,2]{label=\raise 0.1em\hbox{\tiny$$\blacktriangleright$$}}

% Header/footer
\usepackage{fancyhdr}
\pagestyle{fancy}
\fancyhf{}
\rhead{$email$}
\lhead{Dimitrije RadojeviÄ‡}
\rfoot{Page \thepage}

\usepackage{titling}
\usepackage{graphicx}
\setlength{\droptitle}{-90pt} % The negative number moves the title closer to the top of the page

\title{\textsc{Curriculum Vitae} \\ \Huge{$title$}}
\date{$if(date)$$date$\\$endif$}
\author{
    \href{https://dimitrije.website}{$website$} \faGlobe \, \textbar{}
    \href{mailto:me@dimitrije.website}{$email$} \faEnvelopeSquare \\ % new line here
    \href{https://github.com/$github$}{$github$} \faGithub \, \textbar{}
    \href{https://twitter.com/@$twitter$}{@$twitter$} \faTwitter \, \textbar{}
    \href{https://www.linkedin.com/in/$linkedin$}{$linkedin$} \faLinkedin
}

% Left text horizontal adjustment for author and date
\preauthor{\begin{flushleft}}
\postauthor{\par\end{flushleft}}
\predate{\begin{flushleft}}
\postdate{\par\end{flushleft}}

\usepackage{wrapfig}
% set up \maketitle to accept a new item
\pretitle{\begin{flushleft}}
\posttitle{\par\end{flushleft}}

\newcommand{\published}[1]{%
    \gdef\puB{#1}}
\newcommand{\puB}{}
\renewcommand{\maketitlehooka}{%
    \par\noindent \puB}

\published{%
    \begin{wrapfigure}[10]{r}{5cm}%
        %\rule{4cm}{5cm}%
        \includegraphics[width=4cm]{cv-profile}%
    \end{wrapfigure}}


% BEGIN DOCUMENT
\begin{document}
\maketitle
\thispagestyle{empty}
\begin{raggedright}
$body$
\end{raggedright}
\end{document}
